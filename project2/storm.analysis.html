<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Reproducible Research: Peer Assessment 2</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Reproducible Research: Peer Assessment 2</h1>

<h1>Health and Economic Impact of Weather Events in the US</h1>

<p>Storms and other severe weather events can cause both public health and economic
problems for communities and municipalities. Many severe events can result in
fatalities, injuries, and property damage, and preventing such outcomes to the extent
possible is a key concern.</p>

<p>This project involves exploring the U.S. National Oceanic and Atmospheric
Administration&#39;s (NOAA) storm database. This database tracks characteristics of major
storms and weather events in the United States, including when and where they occur, as
well as estimates of any fatalities, injuries, and property damage.</p>

<h1>Synopsis</h1>

<p>The analysis on the storm event database revealed that tornadoes are the most
dangerous weather event to the population health. The second most dangerous
event type is the excessive heat. The economic impact of weather events was
also analyzed. Flash floods and thunderstorm winds caused billions of dollars
in property damages between 1950 and 2011. The largest crop damage caused by
drought, followed by flood and hails.</p>

<h1>Data Processing</h1>

<p>The analysis was performed on
<a href="http://www.ncdc.noaa.gov/stormevents/ftp.jsp">Storm Events Database</a>, provided by
<a href="http://www.ncdc.noaa.gov/">National Climatic Data Center</a>. The data is from a comma-separated-value file available
<a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2">here</a>.
There is also some documentation of the data available
<a href="https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf">here</a>.</p>

<ul>
<li>Load all the required library</li>
</ul>

<pre><code class="r">options( warn = -1 )
is.installed &lt;- function(mypkg) is.element(mypkg, installed.packages()[,1]) 
if (is.installed(&#39;dplyr&#39;) == &#39;FALSE&#39;) {install.packages(&quot;dplyr&quot;);library(dplyr)} else{library(dplyr)}
if (is.installed(&#39;ggthemes&#39;) == &#39;FALSE&#39;) {install.packages(&quot;ggthemes&quot;);library(ggthemes)} else{library(ggthemes)}
if (is.installed(&#39;scales&#39;) == &#39;FALSE&#39;) {install.packages(&quot;scales&quot;);library(scales)} else{library(scales)}
if (is.installed(&#39;RColorBrewer&#39;) == &#39;FALSE&#39;) {install.packages(&quot;RColorBrewer&quot;);library(RColorBrewer)} else{library(RColorBrewer)}
if (is.installed(&#39;lubridate&#39;) == &#39;FALSE&#39;) {install.packages(&quot;lubridate&quot;);library(lubridate)} else{library(lubridate)}
if (is.installed(&#39;ggplot2&#39;) == &#39;FALSE&#39;) {install.packages(&quot;ggplot2&quot;);library(ggplot2)} else{library(ggplot2)}
if (is.installed(&#39;plyr&#39;) == &#39;FALSE&#39;) {install.packages(&quot;plyr&quot;);library(plyr)} else{library(plyr)}
if (is.installed(&#39;knitr&#39;) == &#39;FALSE&#39;) {install.packages(&quot;knitr&quot;);library(knitr)} else{library(knitr)}
if (is.installed(&#39;lattice&#39;) == &#39;FALSE&#39;) {install.packages(&quot;lattice&quot;);library(lattice)} else{library(lattice)}
if (is.installed(&#39;RCurl&#39;) == &#39;FALSE&#39;) {install.packages(&quot;RCurl&quot;);library(RCurl)} else{library(RCurl)}
if (is.installed(&#39;reshape&#39;) == &#39;FALSE&#39;) {install.packages(&quot;reshape&quot;);library(reshape)} else{library(reshape)}
if (is.installed(&#39;car&#39;) == &#39;FALSE&#39;) {install.packages(&quot;car&quot;);library(car)} else{library(car)}
if (is.installed(&#39;gridExtra&#39;) == &#39;FALSE&#39;) {install.packages(&quot;gridExtra&quot;);library(gridExtra)} else{library(gridExtra)}
if (is.installed(&#39;grid&#39;) == &#39;FALSE&#39;) {install.packages(&quot;grid&quot;);library(grid)} else{library(grid)}
if (is.installed(&#39;xtable&#39;) == &#39;FALSE&#39;) {install.packages(&quot;xtable&quot;);library(xtable)} else{library(xtable)}
</code></pre>

<ul>
<li>The first step is to read the data into a data frame.</li>
</ul>

<pre><code class="r">options( warn = -1 )
curdir &lt;-getwd()
file.url&lt;-&#39;http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2&#39;
download.file(file.url,destfile=paste(curdir,&#39;/repdata%2Fdata%2FStormData.csv.bz2&#39;,sep=&quot;&quot;))
storm &lt;- read.csv(bzfile(paste(curdir,&#39;/repdata%2Fdata%2FStormData.csv.bz2&#39;,sep=&quot;&quot;)))
</code></pre>

<pre><code>## [1] 985
</code></pre>

<ul>
<li>Get the no. of event types</li>
</ul>

<pre><code class="r">length(unique(storm$EVTYPE))
</code></pre>

<pre><code>## [1] 985
</code></pre>

<ul>
<li>Converting letters to lower casing</li>
</ul>

<pre><code class="r">event_types &lt;- tolower(storm$EVTYPE)
</code></pre>

<ul>
<li>Replace punctation characters with a space</li>
</ul>

<pre><code class="r">event_types &lt;- gsub(&quot;[[:blank:][:punct:]+]&quot;, &quot; &quot;, event_types)
</code></pre>

<ul>
<li>Get the unique of event types</li>
</ul>

<pre><code class="r">length(unique(event_types))
</code></pre>

<pre><code>## [1] 874
</code></pre>

<ul>
<li>Get the casualities</li>
</ul>

<pre><code class="r">library(plyr)
casualties &lt;- ddply(storm, .(EVTYPE), summarize,
                    fatalities = sum(FATALITIES),
                    injuries = sum(INJURIES))
</code></pre>

<ul>
<li>Find events which causing most injury and death</li>
</ul>

<pre><code class="r">fatal_events &lt;- head(casualties[order(casualties$fatalities, decreasing = T), ], 10)
injury_events &lt;- head(casualties[order(casualties$injuries, decreasing = T), ], 10)
fatal_events[, c(&quot;EVTYPE&quot;, &quot;fatalities&quot;)]
injury_events[, c(&quot;EVTYPE&quot;, &quot;injuries&quot;)]
</code></pre>

<pre><code>##             EVTYPE fatalities
## 834        TORNADO       5633
## 130 EXCESSIVE HEAT       1903
## 153    FLASH FLOOD        978
## 275           HEAT        937
## 464      LIGHTNING        816
## 856      TSTM WIND        504
## 170          FLOOD        470
## 585    RIP CURRENT        368
## 359      HIGH WIND        248
## 19       AVALANCHE        224
</code></pre>

<pre><code>##                EVTYPE injuries
## 834           TORNADO    91346
## 856         TSTM WIND     6957
## 170             FLOOD     6789
## 130    EXCESSIVE HEAT     6525
## 464         LIGHTNING     5230
## 275              HEAT     2100
## 427         ICE STORM     1975
## 153       FLASH FLOOD     1777
## 760 THUNDERSTORM WIND     1488
## 244              HAIL     1361
</code></pre>

<ul>
<li>Define function for exponent transformation and apply the transformation</li>
</ul>

<pre><code class="r">exp_transform &lt;- function(e) {
    # h -&gt; hundred, k -&gt; thousand, m -&gt; million, b -&gt; billion
    if (e %in% c(&#39;h&#39;, &#39;H&#39;))
        return(2)
    else if (e %in% c(&#39;k&#39;, &#39;K&#39;))
        return(3)
    else if (e %in% c(&#39;m&#39;, &#39;M&#39;))
        return(6)
    else if (e %in% c(&#39;b&#39;, &#39;B&#39;))
        return(9)
    else if (!is.na(as.numeric(e))) # if a digit
        return(as.numeric(e))
    else if (e %in% c(&#39;&#39;, &#39;-&#39;, &#39;?&#39;, &#39;+&#39;))
        return(0)
    else {
        stop(&quot;Invalid exponent value.&quot;)
    }
}

prop_dmg_exp &lt;- sapply(storm$PROPDMGEXP, FUN=exp_transform)
storm$prop_dmg &lt;- storm$PROPDMG * (10 ** prop_dmg_exp)
crop_dmg_exp &lt;- sapply(storm$CROPDMGEXP, FUN=exp_transform)
storm$crop_dmg &lt;- storm$CROPDMG * (10 ** crop_dmg_exp)

</code></pre>

<ul>
<li>Calculating loss by event type</li>
</ul>

<pre><code class="r">library(plyr)
econ_loss &lt;- ddply(storm, .(EVTYPE), summarize,
                   prop_dmg = sum(prop_dmg),
                   crop_dmg = sum(crop_dmg))

</code></pre>

<ul>
<li>Removing events with no loss</li>
</ul>

<pre><code class="r">econ_loss &lt;- econ_loss[(econ_loss$prop_dmg &gt; 0 | econ_loss$crop_dmg &gt; 0), ]
prop_dmg_events &lt;- head(econ_loss[order(econ_loss$prop_dmg, decreasing = T), ], 10)
crop_dmg_events &lt;- head(econ_loss[order(econ_loss$crop_dmg, decreasing = T), ], 10)
prop_dmg_events[, c(&quot;EVTYPE&quot;, &quot;prop_dmg&quot;)]
crop_dmg_events[, c(&quot;EVTYPE&quot;, &quot;crop_dmg&quot;)]
</code></pre>

<pre><code>##                 EVTYPE     prop_dmg
## 153        FLASH FLOOD 6.820237e+13
## 786 THUNDERSTORM WINDS 2.086532e+13
## 834            TORNADO 1.078951e+12
## 244               HAIL 3.157558e+11
## 464          LIGHTNING 1.729433e+11
## 170              FLOOD 1.446577e+11
## 411  HURRICANE/TYPHOON 6.930584e+10
## 185           FLOODING 5.920825e+10
## 670        STORM SURGE 4.332354e+10
## 310         HEAVY SNOW 1.793259e+10
</code></pre>

<pre><code>##                EVTYPE    crop_dmg
## 95            DROUGHT 13972566000
## 170             FLOOD  5661968450
## 590       RIVER FLOOD  5029459000
## 427         ICE STORM  5022113500
## 244              HAIL  3025974480
## 402         HURRICANE  2741910000
## 411 HURRICANE/TYPHOON  2607872800
## 153       FLASH FLOOD  1421317100
## 140      EXTREME COLD  1292973000
## 212      FROST/FREEZE  1094086000
</code></pre>

<ul>
<li>Set the levels in order  and produce 2 types of graph and combined as Top deadly weather</li>
</ul>

<pre><code class="r">library(ggplot2)
library(gridExtra)

p1 &lt;- ggplot(data=fatal_events,
             aes(x=reorder(EVTYPE, fatalities), y=fatalities, fill=fatalities)) +
    geom_bar(stat=&quot;identity&quot;) +
    coord_flip() +
    ylab(&quot;Total number of fatalities&quot;) +
    xlab(&quot;Event type&quot;) +
    theme(legend.position=&quot;none&quot;)

p2 &lt;- ggplot(data=injury_events,
             aes(x=reorder(EVTYPE, injuries), y=injuries, fill=injuries)) +
    geom_bar(stat=&quot;identity&quot;) +
    coord_flip() + 
    ylab(&quot;Total number of injuries&quot;) +
    xlab(&quot;Event type&quot;) +
    theme(legend.position=&quot;none&quot;)

grid.arrange(p1, p2 , ncol=1, nrow=2, top = &quot;Top deadly weather events in the US (1950-2011)&quot;)  
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<ul>
<li>Set the levels in order  and produce 2 types of graph and combined as Weather costs</li>
</ul>

<pre><code class="r">library(ggplot2)
library(gridExtra)
# Set the levels in order
p1 &lt;- ggplot(data=prop_dmg_events,
             aes(x=reorder(EVTYPE, prop_dmg), y=log10(prop_dmg), fill=prop_dmg )) +
    geom_bar(stat=&quot;identity&quot;) +
    coord_flip() +
    xlab(&quot;Event type&quot;) +
    ylab(&quot;Property damage in dollars (log-scale)&quot;) +
    theme(legend.position=&quot;none&quot;)

p2 &lt;- ggplot(data=crop_dmg_events,
             aes(x=reorder(EVTYPE, crop_dmg), y=crop_dmg, fill=crop_dmg)) +
    geom_bar(stat=&quot;identity&quot;) +
    coord_flip() + 
    xlab(&quot;Event type&quot;) +
    ylab(&quot;Crop damage in dollars&quot;) + 
    theme(legend.position=&quot;none&quot;)

grid.arrange(p1, p2 , ncol=1, nrow=2, top = &quot;Weather costs to the US economy (1950-2011)&quot;)  
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

</body>

</html>
